<!DOCTYPE html>
<html>
<head>
<title>Aquicklymadeshootyygame</title>
</head>
<body>
<img src="https://web-wirer.github.io/Wall.png"style="display:none" id = "wall"/>
<img src = "https://web-wirer.github.io/Player%20for%20shooter.png"style="display:none"   id = "player"/>
<img src = "https://web-wirer.github.io/Enemy%20for%20shooter.png" style="display: none" id = "enemy"/>
<img src = "https://web-wirer.github.io/Bullet.png" style="display: none" id = "default_bullet"/>
<canvas id="one" width = "1000" height ="1000"></canvas>
<a href='http://web-wirer.github.io/Settings.html' target = "_self" class = "imglink" ><img src="https://web-wirer.github.io/Settings.png" style="position:absolute; width:100px; left: 94%; top: 10px;"/></a>
<script>
//variable and canvas setup
var canvas = document.getElementById("one");
var ctx = canvas.getContext("2d");
    var mouseONE;
    var mouseTWO;
    var pathfinds;
    var positt;
    var posittt;
    var poso;
    var post;
var bulletss=[];
var walls= [];
var enemies=[];
var levels=[];
var spawnPoints=[];
var powerUps=[];
var  playerC = 0;
var ans;
var opp;
    var done =0;
var adj;
var almost;
    var E = 0;
  var q = 0;
  var eq =0;
  var eans;
    var spawns=[];
var eopp;
var eadj;
var ealmost;
var enemyC = document.getElementById("enemy");
var wall = document.getElementById("wall");
var player= document.getElementById("player");
var bullet = document.getElementById("default_bullet");
 function setCookie(cname, cvalue, exdays) {
  const d = new Date();
  d.setTime(d.getTime() + (exdays*24*60*60*1000));
  let expires = "expires="+ d.toUTCString();
  document.cookie = cname + "=" + cvalue + ";" + expires + ";domain=web-wirer.github.io;path=/";
}
function getCookie(cname) {
  let name = cname + "=";
  let decodedCookie = decodeURIComponent(document.cookie);
  let ca = decodedCookie.split(';');
  for(let i = 0; i <ca.length; i++) {
    let c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      return c.substring(name.length, c.length);
    }
  }
  return "";
}
    function checkCookie(fun,more,agh,aggh) {
  let move = getCookie(fun);
  if (move === agh||move===aggh) {
 return;
  } else {   
      setCookie(fun, more, 365);
  }
}
    checkCookie("Movement Type","Absolute","Absolute","Relative");
    checkCookie("togglef","No","Yes","No");
    var movement= getCookie("Movement Type");
    var tog= getCookie("togglef");
    
function radians_to_degrees(radians) {
  return radians * (180 / Math.PI);
}
function degrees_to_radians(degrees) {
  return degrees * (Math.PI / 180);
}
Array.prototype.cnf= function(w,s,t=true){
    
for(var i=0;i<this.length;i++){
    if(this[i].substr(0,this[i].length-(this[i].length-this[i].indexOf("_",this[i].indexOf("_")+1)))===s.substr(0,s.length-(s.length-s.indexOf("_",s.indexOf("_")+1)))){
      if(t){
          return true;
    }else{
          return i;
    }}
}
}
//enemy object
enemy= function(x,y,maxHealth,wepDamage,weapon="gun",speed=1){
this.x = (x*138)+((138/2)-(62.5/2));
this.y=(y*138)+((138/2)-(62.5/2));
this.health= maxHealth;
this.maxHealth = maxHealth;
this.wepDamage = wepDamage;
this.width=62.5;
    this.height=62.5;
this.isResting=true;
    this.type="enemy";
this.wakeDistance=300;
this.rotation=0;
  this.cdd=0;
    this.bulletss = [];
  this.cd=0;
    this.hasShot=0;
    this.xmotion=0;
    this.ymotion=0;
    this.path=[];
        this.pathdupe=[];
    this.pc=0;
    this.insight=false;
    this.hasfound=false;
    this.pathdupes=[];
    
};
//players object
players= function(x,y,maxHealth,wepDamage, speed=1){
this.x = (x*138)+((138/2)-(62.5/2));
this.y=(y*138)+((138/2)-(62.5/2));
this.width=62.5;
this.height=62.5;
    this.type="players";
this.health= maxHealth;
this.maxHealth = maxHealth;
this.wepDamage = wepDamage;
this.rotation=0;
this.xmotion=0;
this.ymotion=0;
 this.cd=0;
 this.startPos={x:(x*138)+((138/2)-(62.5/2)),y:(y*138)+((138/2)-(62.5/2))};
 this.averaged=[125];
 this.vectora=6.25;
this.isMoving=false;
};
//wall object
stopper=function(gridx,gridy){
this.gridx=gridx;
this.gridy=gridy;
this.x = gridx*138;
this.y=gridy*138;
this.xt=this.x+125;
this.yt=this.y+125;
}
 function aimbot(prop){
  if(playerC[prop]===0){
   return 0;
  }else{
  return ((playerC.vectora/playerC[prop])*6.25);
  }
 }
//bullets
bullets=function(x,y,type,shooter,shooterTeam,xmotion,ymotion,rotation){
this.x = x;
  this.y = y;
  this.rotation = rotation;
  this.type="bullet";
this.xmotion=xmotion;
this.ymotion=ymotion;
    this.width=62.5/3.1622;
this.height=62.5/3.1622;
    this.exists=true;
    
}
    //LEVEL GENERATION! 
    var start_level=[
'7',
'9',
'WWWWWWWWW',
'W   E   W',
'W WWWWWWW',
'W W  P  W',
'W W     W',
'W       W',
'WWWWWWWWW'
    ];
true_load = function(){
    walls=[];
    enemies=[];
    for(var i =0; i<start_level[0];i++){
        for (var j =0;j<start_level[1];j++){
            var k =start_level[i+2].substring(j,j+1);
            if(k==="W"){
                walls.push(new stopper(j,i));
            }
            if(k==="P"){
                playerC=new players(j,i,3,1);
        }
            if(k==="E"){
                enemies.push(new enemy(j,i,200,1));
            }
    }
}
}
var current_level= {Width:5,Height:5};
level_observer = function(){
   for(var i =0; i<start_level[0];i++){
        for (var j =0;j<start_level[1];j++){
             var posit= i.toString().concat("_",j.toString());
            current_level[posit]=[];
    if(Math.floor(playerC.x/138)===j&&Math.floor(playerC.y/138)===i){
    current_level[posit].push("P");
    }
            for(var m =0;m<walls.length;m++){
    if(walls[m].gridx===j&&walls[m].gridy===i){
    current_level[posit]=["W"];}}
                    for(var m =0;m<enemies.length;m++){
    if(Math.floor(enemies[m].x/138)===j&&Math.floor(enemies[m].y/138)===i){
    current_level[posit].push("E");
        
     
    }}
     current_level[posit].push("_");
                
}}}
    true_load();
    level_observer();
 enemy.prototype.fire = function(){
adj = Math.abs(this.x+(62.5/2)-(playerC.x+(62.5/2)));
opp = Math.abs(this.y+(62.5/2)-(playerC.y+(62.5/2)));
hyp= Math.sqrt((adj*adj)+(opp*opp));
 var future= hyp/13;
if(playerC.isMoving){
adj = Math.abs((this.x+(62.5/2))-((playerC.x+(62.5/2))+(future*aimbot("xmotion"))));
opp = Math.abs((this.y+(62.5/2))-((playerC.y+(62.5/2))+(future*aimbot("ymotion"))));}
if(adj===0){adj=0.0001;}
  
        if(opp===0){opp=0.0001;}
  var st = ((adj/opp)/((adj/opp)+1))*13;
  var sh = ((opp/adj)/((opp/adj)+1))*13;
  if(eq==1){
  st = st;
   sh = sh;
  }else if(eq==2){
    st = st*-1;
   sh = sh;
     this.bulletss.push(new bullets(this.x+(62.5/2)-((62.5/3.1622)/2),this.y+(62.5/2)-((62.5/3.1622)/2),"reg",this,"enemy",st,sh,this.rotation+90));
  
    return;
  }else if(eq==3){
    st = st*-1;
   sh = sh*-1;
  }else if(eq==4){
    st = st;
   sh = sh*-1;
         this.bulletss.push(new bullets(this.x+(62.5/2)-((62.5/3.1622)/2),this.y+(62.5/2)-((62.5/3.1622)/2),"reg",this,"enemy",st,sh,this.rotation+90));
    return;
  }
   this.bulletss.push(new bullets(this.x+(62.5/2)-((62.5/3.1622)/2),this.y+(62.5/2)-((62.5/3.1622)/2),"reg",this,"enemy",st,sh,this.rotation+90));}
   
//drawing things
enemy.prototype.draw=function(){
var translateX= this.x+(62.5/2);
var translateY= this.y+(62.5/2);
ctx.save();
ctx.translate(translateX,translateY);
ctx.rotate(this.rotation*Math.PI/180);
ctx.translate(-translateX,-translateY);
ctx.drawImage(enemyC,this.x,this.y,62.5,62.5);
ctx.restore();}
  //bullets
bullets.prototype.draw=function(){
    if(this.exists){
var translateX= this.x+((62.5/3.1622)/2);
var translateY= this.y+((62.5/3.1622)/2);
ctx.save();
ctx.translate(translateX,translateY);
ctx.rotate(this.rotation*Math.PI/180);
ctx.translate(-translateX,-translateY);
ctx.drawImage(bullet,this.x,this.y,(62.5)/3.1622,(62.5)/3.1622);
ctx.restore();}}
players.prototype.draw=function(){
var translateX= this.x+(62.5/2);
var translateY= this.y+(62.5/2);
ctx.save();
ctx.translate(translateX,translateY);
ctx.rotate(this.rotation*Math.PI/180);
ctx.translate(-translateX,-translateY);
ctx.drawImage(player,this.x,this.y,62.5,62.5);
ctx.restore();
};
    //THIS STUPID THING
    Mouse=function(e){
        mouseONE=e.offsetX;
        mouseTWO=e.offsetY;
    }
    
  //bullet shooting
fire = function(){
    if(bulletss.length===0){
  //some math that might not work
adj = Math.abs((playerC.x+(62.5/2))-mouseONE);
opp = Math.abs((playerC.y+(62.5/2))-mouseTWO);
if(adj===0){adj=0.0001;}
        if(opp===0){opp=0.0001;}
  var st = ((adj/opp)/((adj/opp)+1))*13;
  var sh = ((opp/adj)/((opp/adj)+1))*13;;
  if(q==1){
  st = st;
   sh = sh;
  }else if(q==2){
    st = st*-1;
   sh = sh;
     bulletss.push(new bullets(playerC.x+(62.5/2)-((62.5/3.1622)/2),playerC.y+(62.5/2)-((62.5/3.1622)/2),"reg",playerC,"players",st,sh,playerC.rotation+90));
    return;
  }else if(q==3){
    st = st*-1;
   sh = sh*-1;
  }else if(q==4){
    st = st;
   sh = sh*-1;
         bulletss.push(new bullets(playerC.x+(62.5/2)-((62.5/3.1622)/2),playerC.y+(62.5/2)-((62.5/3.1622)/2),"reg",playerC,"players",st,sh,playerC.rotation+90));
    return;
  }
   bulletss.push(new bullets(playerC.x+(62.5/2)-((62.5/3.1622)/2),playerC.y+(62.5/2)-((62.5/3.1622)/2),"reg",playerC,"players",st,sh,playerC.rotation+90));
 
  }}
  //bullet motion
  bullets.prototype.move= function(){
  this.x +=this.xmotion;
    this.y +=this.ymotion;
  };
stopper.prototype.draw = function(){
ctx.drawImage(wall,this.x,this.y,125,125);
}
stop = function(obj){
    post=Math.floor((obj.x+obj.xmotion)/138);
    poso=Math.floor((obj.y+obj.ymotion)/138);
     positt= poso.toString().concat("_",post.toString());
    try{
if(current_level[positt].length>0){
if(current_level[positt][0]==="W"){
 
return;
}}}catch{
        return;
}
    post=Math.floor((obj.x+obj.xmotion+obj.width)/138);
    poso=Math.floor((obj.y+obj.ymotion+obj.height)/138);
     positt= poso.toString().concat("_",post.toString());
    try{
if(current_level[positt].length>0){
if(current_level[positt][0]==="W"){
 
return;
}}}catch{
        return;
}
    post=Math.floor((obj.x+obj.xmotion+obj.width)/138);
    poso=Math.floor((obj.y+obj.ymotion)/138);
     positt= poso.toString().concat("_",post.toString());
    try{
if(current_level[positt].length>0){
if(current_level[positt][0]==="W"){
 
return;
}}}catch{
        return;
}
    post=Math.floor((obj.x+obj.xmotion)/138);
    poso=Math.floor((obj.y+obj.ymotion+obj.height)/138);
     positt= poso.toString().concat("_",post.toString());
    try{
if(current_level[positt].length>0){
if(current_level[positt][0]==="W"){
 
return;
}}}catch{
        return;
}
return(true);
}
    shop= function(obj){
 
  
if((obj.x+obj.width)>(playerC.x-3)&&(obj.x+obj.width)<playerC.width+5+playerC.x&&(obj.y+obj.height)>(playerC.y-6)&&(obj.y+obj.height)<playerC.height+9+playerC.y){
 
return(false);
    
}else if(obj.x+4>playerC.x&&obj.x<playerC.width+playerC.x&&obj.y>playerC.y-6&&obj.y<playerC.height+6+playerC.y){
return(false);
}
return(true);
}
    //math is pain.
point = function(){
adj = Math.abs((playerC.x+(62.5/2))-mouseONE);
opp = Math.abs((playerC.y+(62.5/2))-mouseTWO);
    hyp= Math.sqrt((adj*adj)+(opp*opp));
almost = opp/hyp;
ans = Math.asin(almost);
ans=radians_to_degrees(ans);
 if(playerC.x+(62.5/2)<mouseONE&&playerC.y+(62.5/2)<mouseTWO){
   q=1;
playerC.rotation=ans;
return;
}else if(playerC.x+(62.5/2)>mouseONE&&playerC.y+(62.5/2)<mouseTWO){
ans= 180-ans;
  q=2;
playerC.rotation=ans;
return;
}else if(playerC.x+(62.5/2)>mouseONE&&playerC.y+(62.5/2)>mouseTWO){
ans=180+ans;
  q=3;
playerC.rotation= ans;
return;
}else if(playerC.x+(62.5/2)<mouseONE&&playerC.y+(62.5/2)>mouseTWO){
ans= 360-ans;
  q=4;
playerC.rotation=ans;
return;
}
}
 enemy.prototype.dist = function(obj){
 var p = Math.abs((obj.x+(62.5/2))-(this.x+(62.5/2)));
var o = Math.abs((obj.y+(62.5/2))-(this.y+(62.5/2)));
var m = Math.pow(p,2);
   var n = Math.pow(o,2);
   var b = m+n;
   var c = Math.sqrt(b);
   return c;
 }
    dist = function(objo,objt){
 var p = Math.abs((objo.x+(62.5/2))-(objt.x+(62.5/2)));
var o = Math.abs((objo.y+(62.5/2))-(objt.y+(62.5/2)));
var m = Math.pow(p,2);
   var n = Math.pow(o,2);
   var b = m+n;
   var c = Math.sqrt(b);
   return c;
 }
//math is pain.
enemy.prototype.point = function(){
    if(this.hasfound){
var yy = (((parseFloat((this.path[0].substr(0,this.path[0].indexOf("_")))))*138)+31.25);
var xx = (((parseFloat(this.path[0].substr(this.path[0].indexOf("_")+1,this.path[0].indexOf("_",(this.path[0].indexOf("_"))))))*138)+31.25);
adj = Math.abs(this.y-(((parseFloat((this.path[0].substr(0,this.path[0].indexOf("_")))))*138)+31.25));
opp = Math.abs(this.x-(((parseFloat(this.path[0].substr(this.path[0].indexOf("_")+1,this.path[0].indexOf("_",(this.path[0].indexOf("_"))))))*138)+31.25));
    hyp= Math.sqrt((adj*adj)+(opp*opp));
    almost = opp/hyp;
  
ans = Math.asin(almost);
ans=radians_to_degrees(ans);
 
 if(this.x<xx&&this.y<yy){
   eq=1;
this.rotation=ans;
return;
}else if(this.x>xx&&this.y<yy){
ans= 180-ans;
  eq=2;
this.rotation=ans;
return;
}else if(this.x>xx&&this.y>yy){
ans=180+ans;
  eq=3;
this.rotation= ans;
return;
}else if(this.x<xx&&this.y>yy){
ans= 360-ans;
  eq=4;
this.rotation=ans;
return;}
    
    
    }else{
 var future= hyp/13;
if(playerC.isMoving){
adj = Math.abs((this.x+(62.5/2))-((playerC.x+(62.5/2))+(future*aimbot("xmotion"))));
opp = Math.abs((this.y+(62.5/2))-((playerC.y+(62.5/2))+(future*aimbot("ymotion"))));

    hyp= Math.sqrt((adj*adj)+(opp*opp));
almost = opp/hyp;
  
ans = Math.asin(almost);
ans=radians_to_degrees(ans);
 
 if(this.x+(62.5/2)<(playerC.x+(62.5/2))+(future*aimbot("xmotion"))&&this.y+(62.5/2)<(playerC.y+(62.5/2))+(future*aimbot("ymotion"))){
   eq=1;
this.rotation=ans;
return;
}else if(this.x+(62.5/2)>(playerC.x+(62.5/2))+(future*aimbot("xmotion"))&&this.y+(62.5/2)<(playerC.y+(62.5/2))+(future*aimbot("ymotion"))){
ans= 180-ans;
  eq=2;
this.rotation=ans;
return;
}else if(this.x+(62.5/2)>(playerC.x+(62.5/2))+(future*aimbot("xmotion"))&&this.y+(62.5/2)>(playerC.y+(62.5/2))+(future*aimbot("ymotion"))){
ans=180+ans;
  eq=3;
this.rotation= ans;
return;
}else if(this.x+(62.5/2)<(playerC.x+(62.5/2))+(future*aimbot("xmotion"))&&this.y+(62.5/2)>(playerC.y+(62.5/2))+(future*aimbot("ymotion"))){
ans= 360-ans;
  eq=4;
this.rotation=ans;
return;
}}else{
     hyp= Math.sqrt((adj*adj)+(opp*opp));
almost = opp/hyp;
ans = Math.asin(almost);
ans=radians_to_degrees(ans);
 
 if(this.x+(62.5/2)<(playerC.x+(62.5/2))+(future*playerC.xmotion)&&this.y+(62.5/2)<(playerC.y+(62.5/2))+(future*playerC.ymotion)){
   eq=1;
this.rotation=ans;
return;
}else if(this.x+(62.5/2)>(playerC.x+(62.5/2))+(future*playerC.xmotion)&&this.y+(62.5/2)<(playerC.y+(62.5/2))+(future*playerC.ymotion)){
ans= 180-ans;
  eq=2;
this.rotation=ans;
return;
}else if(this.x+(62.5/2)>(playerC.x+(62.5/2))+(future*playerC.xmotion)&&this.y+(62.5/2)>(playerC.y+(62.5/2))+(future*playerC.ymotion)){
ans=180+ans;
  eq=3;
this.rotation= ans;
return;
}else if(this.x+(62.5/2)<(playerC.x+(62.5/2))+(future*playerC.xmotion)&&this.y+(62.5/2)>(playerC.y+(62.5/2))+(future*playerC.ymotion)){
ans= 360-ans;
  eq=4;
this.rotation=ans;
}
}}}
toggle=function(e){
    
        if((e.keyCode===71||e.keyCode===103)&&tog==="Yes"){
if(movement==="Relative"){
    movement="Absolute";
}else{movement="Relative";}
}
}
var map = {}; // You could also use an array
onkeydown = onkeyup = function(e){
    e = e || event; // to deal with IE
    map[e.keyCode] = e.type == 'keydown';
}
move = function(){
 playerC.xmotion=0;
playerC.ymotion=0;
    adj = Math.abs((playerC.x+(62.5/2))-mouseONE);
opp = Math.abs((playerC.y+(62.5/2))-mouseTWO);
if(adj===0){adj=0.0001;}
        if(opp===0){opp=0.0001;}
  var bt = ((adj/opp)/((adj/opp)+1))*6.25;
  var bh = ((opp/adj)/((opp/adj)+1))*6.25;
if((map[37]||map[65])){
if(movement==="Relative"){
       if(q==1){
             playerC.xmotion+=-bt;
     playerC.ymotion+=-bh;
  }else if(q==2){
               playerC.xmotion+=bt;
     playerC.ymotion+=-bh;
       }else if(q==3){
          playerC.xmotion+=bt;
     playerC.ymotion+=bh;
  }else if(q==4){
           playerC.xmotion+=-bt;
     playerC.ymotion+=bh;}}else{
  playerC.xmotion += -6.25;}}
 if((map[38]||map[87])){
if(movement==="Relative"){
                    if(q==1){
           playerC.xmotion+=bh;
     playerC.ymotion+=-bt;
  }else if(q==2){
           playerC.xmotion+=bh;
     playerC.ymotion+=bt;
       }else if(q==3){
           playerC.xmotion+=-bh;
     playerC.ymotion+=bt;
  }else if(q==4){
           playerC.xmotion+=-bh;
     playerC.ymotion+=-bt;}}else{
 playerC.ymotion += -6.25;}}
 
 if((map[39]||map[68])){
if(movement==="Relative"){
       if(q==1){
  bt = bt;
   bh = bh;
             playerC.xmotion+=bt;
     playerC.ymotion+=bh;
  }else if(q==2){
    bt = bt*-1;
   bh = bh;
               playerC.xmotion+=bt;
     playerC.ymotion+=bh;
       }else if(q==3){
    bt = bt*-1;
   bh = bh*-1;
               playerC.xmotion+=bt;
     playerC.ymotion+=bh;
  }else if(q==4){
    bt = bt;
   bh = bh*-1;
           playerC.xmotion+=bt;
     playerC.ymotion+=bh;}}else{
     
           playerC.xmotion+=6.25;}}
if((map[40]||map[83])){
if(movement==="Relative"){
                    if(q==1){
           playerC.xmotion+=-bh;
     playerC.ymotion+=bt;
  }else if(q==2){
           playerC.xmotion+=-bh;
     playerC.ymotion=-bt;
       }else if(q==3){
           playerC.xmotion+=bh;
     playerC.ymotion+=-bt;
  }else if(q==4){
           playerC.xmotion+=bh;
     playerC.ymotion+=bt;}}else{
 playerC.ymotion += 6.25;}}
 if((map[40]||map[83])||(map[39]||map[68])||(map[37]||map[65])||(map[38]||map[87])){
 playerC.isMoving=true;
}else{
 playerC.isMoving=false;
}
 if(stop(playerC)){
 playerC.x +=playerC.xmotion;
  playerC.y +=playerC.ymotion;}else{
     playerC.xmotion=0;
     playerC.ymotion=0;
  playerC.isMoving=false;
}}
    enemy.prototype.pathfind=function(){

adj = ((this.x+(62.5/2))-((playerC.x+(62.5/2))));
opp = ((this.y+(62.5/2))-((playerC.y+(62.5/2))));
if(adj===0){adj=0.0001;}
  
        if(opp===0){opp=0.0001;}
  var st = ((adj/opp)/((adj/opp)+1))*150;
  var sh = ((opp/adj)/((opp/adj)+1))*150;
if(this.insight){
this.path[0]=[playerC.x+st,playerC.y+sh];}
if(!this.hasfound){
    while(!this.hasfound){


    var gridy = Math.floor((this.x+(62.5/2))/138);
    var gridx = Math.floor((this.y+(62.5/2))/138);
    this.path.shift();
    this.path.unshift(gridx.toString().concat("_",gridy.toString()).concat("_",0));

        this.pc++;
        var leng=this.path.length;
        for(var d=0;d<leng;d++){
         gridx = parseFloat(this.path[d].substr(0,this.path[d].indexOf("_")));
     gridy = parseFloat(this.path[d].substr(this.path[d].indexOf("_")+1,this.path[d].indexOf("_",this.path[d].indexOf("_")+1)-this.path[d].indexOf("_")));
        var moveo=[gridx+1,gridy];
          posittt= moveo[0].toString().concat("_",moveo[1].toString());   
        pathfinds= moveo[0].toString().concat("_",moveo[1].toString()).concat("_",this.pc.toString());   
            var wallis = false;
        for(var i=0;i<current_level[posittt].length;i++){
        if(current_level[posittt][i]==="W"||this.path.cnf(this.pc.toString().length, pathfinds)||wallis||moveo[0]>start_level[0]||moveo[1]>start_level[1]||moveo[0]<0||moveo[1]<0){
            wallis=true;
    }} 
            for(var e=0;e<current_level[posittt].length;e++){
                if(!this.path.cnf(this.pc.toString().length,pathfinds)){
            if(current_level[posittt][e]==="P"&&!wallis&&!this.hasfound){
            this.path.push(pathfinds);
            this.hasfound=true;
            break;
    }else if(!wallis&&!this.hasfound){
     this.path.push(pathfinds);     
    }}}

               var moveo=[gridx,gridy+1];
         posittt= moveo[0].toString().concat("_",moveo[1].toString());   
        pathfinds= moveo[0].toString().concat("_",moveo[1].toString()).concat("_",this.pc.toString());   
             wallis = false;
        for(var i=0;i<current_level[posittt].length;i++){
        if(current_level[posittt][i]==="W"||this.path.cnf(this.pc.toString().length, pathfinds)||wallis||moveo[0]>start_level[0]||moveo[1]>start_level[1]||moveo[0]<0||moveo[1]<0){
            wallis=true;
    }} 
            for(var e=0;e<current_level[posittt].length;e++){
                if(!this.path.cnf(this.pc.toString().length,pathfinds)){
            if(current_level[posittt][e]==="P"&&!wallis&&!this.hasfound){
            this.path.push(pathfinds);
            this.hasfound=true;
            break;
    }else if(!wallis&&!this.hasfound){
     this.path.push(pathfinds);     
    }}}
            var moveo=[gridx-1,gridy];
         posittt= moveo[0].toString().concat("_",moveo[1].toString());   
        pathfinds= moveo[0].toString().concat("_",moveo[1].toString()).concat("_",this.pc.toString());   
             wallis = false;
        for(var i=0;i<current_level[posittt].length;i++){
        if(current_level[posittt][i]==="W"||this.path.cnf(this.pc.toString().length, pathfinds)||wallis||moveo[0]>start_level[0]||moveo[1]>start_level[1]||moveo[0]<0||moveo[1]<0){
            wallis=true;
    }} 
            for(var e=0;e<current_level[posittt].length;e++){
                if(!this.path.cnf(this.pc.toString().length,pathfinds)){
            if(current_level[posittt][e]==="P"&&!wallis&&!this.hasfound){
            this.path.push(pathfinds);
            this.hasfound=true;
            break;
    }else if(!wallis&&!this.hasfound){
     this.path.push(pathfinds);     
    }}}
        var moveo=[gridx,gridy-1];
         posittt= moveo[0].toString().concat("_",moveo[1].toString());   
        pathfinds= moveo[0].toString().concat("_",moveo[1].toString()).concat("_",this.pc.toString());   
             wallis = false;
        for(var i=0;i<current_level[posittt].length;i++){
        if(current_level[posittt][i]==="W"||this.path.cnf(this.pc.toString().length, pathfinds)||wallis||moveo[0]>start_level[0]||moveo[1]>start_level[1]||moveo[0]<0||moveo[1]<0){
            wallis=true;
    }} 
            for(var e=0;e<current_level[posittt].length;e++){
                if(!this.path.cnf(this.pc.toString().length,pathfinds)){
            if(current_level[posittt][e]==="P"&&!wallis&&!this.hasfound){
            this.path.push(pathfinds);
            this.hasfound=true;
            break;
    }else if(!wallis&&!this.hasfound){
     this.path.push(pathfinds);     
    }}}

        
}}
 var leng=this.path.length;
        for(var d=leng-1;d>=0;d--){
         gridx = parseFloat(this.path[d].substr(0,this.path[d].indexOf("_")));
     gridy = parseFloat(this.path[d].substr(this.path[d].indexOf("_")+1,this.path[d].indexOf("_",this.path[d].indexOf("_")+1)-this.path[d].indexOf("_")));
                    pathfinds= gridx.toString().concat("_",gridy.toString()).concat("_",this.path[d].substr(this.path[d].indexOf("_",this.path[d].indexOf("_")+1)+1,this.path[d].length-this.path[d].indexOf("_",this.path[d].indexOf("_"))));        


            if(!this.pathdupes.cnf(1,pathfinds)&&!this.pathdupe.includes(this.path[d].substr(this.path[d].indexOf("_",this.path[d].indexOf("_")+1)+1,this.path[d].length-this.path[d].indexOf("_",this.path[d].indexOf("_"))))){
                           console.log(d);
                this.pathdupe.push(this.path[d].substr(this.path[d].indexOf("_",this.path[d].indexOf("_")+1)+1,this.path[d].length-this.path[d].indexOf("_",this.path[d].indexOf("_"))));
                this.pathdupes.push(pathfinds);
    }
       
                    

 console.log(d);       
}
    this.path=[];
 var leng=this.pathdupes.length;
        for(var d=0;d<leng;d++){
     this.path.unshift(this.pathdupes[d]);
}

}}
  enemy.prototype.move = function(){
    this.pathfind();

var yy = (((parseFloat((this.path[0].substr(0,this.path[0].indexOf("_")))))*138)+62.5);
var xx =(((parseFloat(this.path[0].substr(this.path[0].indexOf("_")+1,this.path[0].indexOf("_",(this.path[0].indexOf("_"))))))*138)+62.5);
opp = Math.abs((this.y+(62.5/2))-(((parseFloat((this.path[0].substr(0,this.path[0].indexOf("_")))))*138)+62.5));
adj = Math.abs((this.x+(62.5/2))-(((parseFloat(this.path[0].substr(this.path[0].indexOf("_")+1,this.path[0].indexOf("_",(this.path[0].indexOf("_"))))))*138)+62.5));
if(adj===0){adj=0.0001;}
  
        if(opp===0){opp=0.0001;}
  var st = ((adj/opp)/((adj/opp)+1))*6.25;
  var sh = ((opp/adj)/((opp/adj)+1))*6.25;
  if(eq==1){
  st = st;
   sh = sh;
  }else if(eq==2){
    st = st*-1;
   sh = sh;
  
  }else if(eq==3){
    st = st*-1;
   sh = sh*-1;
  }else if(eq==4){
    st = st;
   sh = sh*-1;
       
  }
this.xmotion=st;
this.ymotion=sh;
        var pseudo={
x: this.xmotion+this.x,
y: this.ymotion+this.y
}
if(true){
    if(stop(this)){
this.x+=this.xmotion;
this.y+=this.ymotion;}}else if(dist(this,playerC)<350-7.25){
 this.xmotion *= -1;
 this.ymotion *= -1;
 if(stop(this)){
    this.x+=this.xmotion;
    this.y+=this.ymotion;}
}else{
    
}

    if((this.x+(62.5/2))>xx-10&&(this.x+(62.5/2))<xx+10&&(this.y+(62.5/2))>yy-10&&(this.y+(62.5/2))<yy+10){
     this.path.shift();
        
    }
            if(!current_level[this.path[this.path.length-1].substr(0,this.path[this.path.length-1].indexOf("_",(this.path[this.path.length-1].indexOf("_")+1)))].includes("P")){
          this.hasfound=false;
          this.path=[];
          this.pathdupes=[];
          this.pathdupe=[];
                this.pc=0;
                this.pathfind();
      console.log(this);
            }
}
average=function(){
 var d=0;
 for(var i=0;i<playerC.averaged.length;i++){
 d+=playerC.averaged[i];
}
 d=d/playerC.averaged.length;
 playerC.vectora=d/20;
}
game = function(){
ctx.clearRect(0,0,10000,10000);
move();
point();
playerC.draw();
 
for(var i = 0; i<enemies.length; i++){
enemies[i].point();
  enemies[i].draw();
 
  if(enemies[i].dist(playerC)<950){
  enemies[i].isResting=false;
  
  }
    if(!enemies[i].isResting){
        enemies[i].move();
    }
if(enemies[i].bulletss.length>0){
    enemies[i].bulletss[0].move();
        enemies[i].bulletss[0].draw();
  if(enemies[i].dist(playerC)<900&&enemies[i].isResting==false&&enemies[i].dist(enemies[i].bulletss[0])>800){
      enemies[i].bulletss.pop();
  enemies[i].fire();
    
  }
}else{enemies[i].fire();}
  
}
    if(bulletss.length>0){
  if(dist(playerC, bulletss[0])>650){
     bulletss.pop();
  
    }
}
    if(bulletss.length===1){
if(stop(bulletss[0])){
   
}else{bulletss[0].exists=false;}}
for(var daps=0; daps<enemies.length;daps++){
        if(enemies[daps].bulletss.length===1){
    if(stop(enemies[daps].bulletss[0])){
     
    }else{ enemies[daps].bulletss[0].exists=false;   }}
}
    for(var dadps=0; dadps<enemies.length;dadps++){
        if(enemies[dadps].bulletss.length===1){
    if(shop(enemies[dadps].bulletss[0])){
     
    }else if(enemies[dadps].bulletss[0].exists){true_load();}}
}
    
 done=0; 
for(var i = 0; i<walls.length; i++){
walls[i].draw();}
for(var i = 0; i<bulletss.length; i++){
bulletss[i].draw();
bulletss[i].move();}
    
         ctx.strokeStyle = 'red';
    ctx.lineWidth = 5;
    // draw a red line
    ctx.beginPath();
    ctx.moveTo(playerC.x+(62.5/2), playerC.y+(62.5/2));
    ctx.lineTo(mouseONE, mouseTWO);
    ctx.stroke();
for(var i=0;i<enemies.length;i++){
 if(dist(enemies[i],playerC)<700&&!enemies[i].isResting){
 if(playerC.cd<20){
  playerC.cd++;
 }else{
    
  playerC.cd=0;
  playerC.averaged.push(dist(playerC.startPos,playerC));
  average();
  playerC.startPos.x=playerC.x;
  playerC.startPos.y=playerC.y;
 }}}
level_observer();    
window.requestAnimationFrame(game);
    
};
    document.addEventListener("keypress",toggle);
canvas.addEventListener("mousemove",Mouse);
  canvas.addEventListener("click",fire);
game();
</script>
</body></html>
