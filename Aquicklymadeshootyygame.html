<!DOCTYPE html>
<html>
<head>
<title>Aquicklymadeshootyygame</title>
</head>
<body>
<img src="https://web-wirer.github.io/Wall.png"style="display:none" id = "wall"/>
<img src = "https://web-wirer.github.io/Player%20for%20shooter.png"style="display:none"   id = "player"/>
<img src = "https://web-wirer.github.io/Enemy%20for%20shooter.png" style="display: none" id = "enemy"/>
<img src = "https://web-wirer.github.io/Bullet.png" style="display: none" id = "default_bullet"/>
<canvas id="one" width = "1000" height ="1000"></canvas>
<a href='http://web-wirer.github.io/Settings.html' target = "_self" class = "imglink" ><img src="https://web-wirer.github.io/Settings.png" style="position:absolute; width:100px; left: 94%; top: 10px;"/></a>
<script>
//variable and canvas setup
var canvas = document.getElementById("one");
var ctx = canvas.getContext("2d");
    var mouseONE;
    var mouseTWO;
var bulletss=[];
var walls= [];
var enemies=[];
var levels=[];
var spawnPoints=[];
var powerUps=[];
var  playerC = 0;
var ans;
var opp;
    var done =0;
var adj;
var almost;
    var E = 0;
  var q = 0;

  var eq =0;
  var eans;
    var spawns=[];
var eopp;
var eadj;
var ealmost;
var enemyC = document.getElementById("enemy");
var wall = document.getElementById("wall");
var player= document.getElementById("player");
var bullet = document.getElementById("default_bullet");
 function setCookie(cname, cvalue, exdays) {
  const d = new Date();
  d.setTime(d.getTime() + (exdays*24*60*60*1000));
  let expires = "expires="+ d.toUTCString();
  document.cookie = cname + "=" + cvalue + ";" + expires + ";domain=web-wirer.github.io;path=/";
}

function getCookie(cname) {
  let name = cname + "=";
  let decodedCookie = decodeURIComponent(document.cookie);
  let ca = decodedCookie.split(';');
  for(let i = 0; i <ca.length; i++) {
    let c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      return c.substring(name.length, c.length);
    }
  }
  return "";
}
    function checkCookie(fun,more,agh,aggh) {
  let move = getCookie(fun);
  if (move === agh||move===aggh) {
 return;
  } else {   
      setCookie(fun, more, 365);
  }
}
    checkCookie("Movement Type","Absolute","Absolute","Relative");
    checkCookie("togglef","No","Yes","No");

    var movement= getCookie("Movement Type");
    var tog= getCookie("togglef");
    
function radians_to_degrees(radians) {
  return radians * (180 / Math.PI);
}
function degrees_to_radians(degrees) {
  return degrees * (Math.PI / 180);
}
    
//enemy object
enemy= function(x,y,maxHealth,wepDamage,rotation,xmotion,ymotion){
this.x = x;
this.y=y;
this.health= maxHealth;
this.maxHealth = maxHealth;
this.wepDamage = wepDamage;
this.isResting=true;
    this.type="enemy";
this.wakeDistance=180;
this.rotation=rotation;
  this.cdd=0;
    this.bulletss = [];
  this.cd=0;
    this.hasShot=0;
};
//player object
players= function(x,y,maxHealth,wepDamage, speed=1,rotation,xmotion,ymotion){
this.x = x;
this.y=y;
this.width=62.5;
this.height=62.5;
    this.type="player";
this.health= maxHealth;
this.maxHealth = maxHealth;
this.wepDamage = wepDamage;
this.rotation=rotation;
this.xmotion=0;
this.ymotion=0;
  this.cd=0;
};
//wall object
stopper=function(x,y){
this.x = x*138;
this.y=y*138;
this.xt=this.x+125;
this.yt=this.y+125;
}
// spawning creatures/items
spawnPoint=function(x,y,type, cooldown,uses,power){
this.x=x;
this.y=y;
this.type=type;
this.cooldown=cooldown;
this.uses=uses;
  this.power=power;
}
//bullets
bullets=function(x,y,type,shooter,shooterTeam,xmotion,ymotion,rotation){
this.x = x;
  this.y = y;
  this.rotation = rotation;
  this.type="bullet";

this.xmotion=xmotion;
this.ymotion=ymotion;
    this.width=62.5/3.1622;
this.height=62.5/3.1622;
    this.exists=true;

    
}
    //LEVEL GENERATION! 
    var current_level=[
'5',
'5',
'WWWWW',
'W   W',
'W P W',
'W   W',
'WWWWW'      
    ];
level_object_properties=function(){
    this.1=[];    
};
true_load = function(){
    for(var i =0; i<current_level[0];i++){
        for (var j =0;j<current_level[1];j++){
            var k =current_level[i+2].substring(j,j+1);
            if(k==="W"){
                walls.push(new stopper(j,i));
            }
        }
    }
playerC.x=260;
    playerC.y=270;
}
 enemy.prototype.fire = function(){


   if(eq==1){
      var s =  this.rotation;

  }else if(eq==2){
    var s =  this.rotation-90;
  }else if(eq==3){
       var s =  this.rotation-180;
  }else if(eq==4){
   var s =  this.rotation-270;
  }
  var so = s*(10/9);
  var st = (so/90)*11;
  var sh = 11-st;
  if(eq==1){
  st = st;
   sh = sh;
  }else if(eq==2){
    st = st*-1;
   sh = sh;
     this.bulletss.push(new bullets(this.x,this.y,"reg",this,"enemy",st,sh,this.rotation+90));
    this.cd=1;
 this.hasShot++;
    return;
  }else if(eq==3){
    st = st*-1;
   sh = sh*-1;
  }else if(eq==4){
    st = st;
   sh = sh*-1;
         this.bulletss.push(new bullets(this.x,this.y,"reg",this,"enemy",st,sh,this.rotation+90));
    this.cd=1;
this.hasShot++;
    return;
  }
   this.bulletss.push(new bullets(this.x,this.y,"reg",this,"enemy",sh,st,this.rotation+90));
     this.cd=1;
 this.hasShot++;
   }
//drawing things
enemy.prototype.draw=function(){
var translateX= this.x+(62.5/2);
var translateY= this.y+(62.5/2);
ctx.save();
ctx.translate(translateX,translateY);
ctx.rotate(this.rotation*Math.PI/180);
ctx.translate(-translateX,-translateY);
ctx.drawImage(enemyC,this.x,this.y,62.5,62.5);
ctx.restore();}
  //bullets
bullets.prototype.draw=function(){
    if(this.exists){
var translateX= this.x+((62.5/3.1622)/2);
var translateY= this.y+((62.5/3.1622)/2);
ctx.save();
ctx.translate(translateX,translateY);
ctx.rotate(this.rotation*Math.PI/180);
ctx.translate(-translateX,-translateY);
ctx.drawImage(bullet,this.x,this.y,(62.5)/3.1622,(62.5)/3.1622);
ctx.restore();}}

players.prototype.draw=function(){

var translateX= this.x+(62.5/2);
var translateY= this.y+(62.5/2);
ctx.save();
ctx.translate(translateX,translateY);
ctx.rotate(this.rotation*Math.PI/180);
ctx.translate(-translateX,-translateY);
ctx.drawImage(player,this.x,this.y,62.5,62.5);
ctx.restore();

};
    //THIS STUPID THING
    Mouse=function(e){
        mouseONE=e.offsetX;
        mouseTWO=e.offsetY;
    }
    
  //bullet shooting
fire = function(){
    if(bulletss.length===0){
  //some math that might not work


adj = Math.abs((playerC.x+(62.5/2))-mouseONE);
opp = Math.abs((playerC.y+(62.5/2))-mouseTWO);


if(adj===0){adj=0.0001;}
        if(opp===0){opp=0.0001;}

  var st = ((adj/opp)/((adj/opp)+1))*13;
  var sh = ((opp/adj)/((opp/adj)+1))*13;;

  if(q==1){
  st = st;
   sh = sh;
  }else if(q==2){
    st = st*-1;
   sh = sh;
     bulletss.push(new bullets(playerC.x+(62.5/2)-((62.5/3.1622)/2),playerC.y+(62.5/2)-((62.5/3.1622)/2),"reg",playerC,"player",st,sh,playerC.rotation+90));
    return;
  }else if(q==3){
    st = st*-1;
   sh = sh*-1;
  }else if(q==4){
    st = st;
   sh = sh*-1;
         bulletss.push(new bullets(playerC.x+(62.5/2)-((62.5/3.1622)/2),playerC.y+(62.5/2)-((62.5/3.1622)/2),"reg",playerC,"player",st,sh,playerC.rotation+90));
    return;
  }
   bulletss.push(new bullets(playerC.x+(62.5/2)-((62.5/3.1622)/2),playerC.y+(62.5/2)-((62.5/3.1622)/2),"reg",playerC,"player",st,sh,playerC.rotation+90));
 
  }}
  //bullet motion
  bullets.prototype.move= function(){
  this.x +=this.xmotion;
    this.y +=this.ymotion;
  };
    enemy.prototype.bulletsmove=function(){
        this.bulletss[0].x +=this.bulletss[0].xmotion;
    this.bulletss[0].y +=this.bulletss[0].ymotion; 
    }
stopper.prototype.draw = function(){
ctx.drawImage(wall,this.x,this.y,125,125);
}
stop = function(obj){
    for(var i = 0; i<walls.length; i++){
  
if((obj.x+obj.width+obj.xmotion)>(walls[i].x-3)&&(obj.x+obj.width+obj.xmotion)<walls[i].xt+5&&(obj.y+obj.height+obj.ymotion)>(walls[i].y-6)&&(obj.y+obj.height+obj.ymotion)<walls[i].yt+9){
 
return(false);


    
}else if(obj.x+obj.xmotion+4>walls[i].x-13&&obj.x+obj.xmotion<walls[i].xt+9&&obj.y+obj.ymotion>walls[i].y-6&&obj.y+obj.ymotion<walls[i].yt+6){
return(false);

}
}
return(true);
}
    shop= function(obj){
 
  
if((obj.x+obj.width)>(playerC.x-3)&&(obj.x+obj.width)<playerC.width+5+playerC.x&&(obj.y+obj.height)>(playerC.y-6)&&(obj.y+obj.height)<playerC.height+9+playerC.y){
 
return(false);


    
}else if(obj.x+4>playerC.x&&obj.x<playerC.width+playerC.x&&obj.y>playerC.y-6&&obj.y<playerC.height+6+playerC.y){
return(false);

}

return(true);
}



playerC= new players(250,250,3,1,0,0);



    //math is pain.
point = function(){

adj = Math.abs((playerC.x+(62.5/2))-mouseONE);
opp = Math.abs((playerC.y+(62.5/2))-mouseTWO);
    hyp= Math.sqrt((adj*adj)+(opp*opp));

almost = opp/hyp;
ans = Math.asin(almost);
ans=radians_to_degrees(ans);

 if(playerC.x+(62.5/2)<mouseONE&&playerC.y+(62.5/2)<mouseTWO){
if (ans>90){
 ans = 90;
}else if(ans<0){
 ans= 0;
}

   q=1;
playerC.rotation=ans;
return;
}else if(playerC.x+(62.5/2)>mouseONE&&playerC.y+(62.5/2)<mouseTWO){
ans= 180-ans;
if (ans<90){
 ans= 90;
}else if(ans>180){
 ans = 270;
}
  q=2;
playerC.rotation=ans;
return;
}else if(playerC.x+(62.5/2)>mouseONE&&playerC.y+(62.5/2)>mouseTWO){
ans=180+ans;
if (ans>270){
ans = 270;
}else if(ans<0){
ans = 180;
}

  q=3;
playerC.rotation= ans;
return;
}else if(playerC.x+(62.5/2)<mouseONE&&playerC.y+(62.5/2)>mouseTWO){
ans= 360-ans;
if (ans>360){
ans = 360;
}else if(ans<270){
ans = 270;
}
  q=4;
playerC.rotation=ans;


return;
}
}

 enemy.prototype.dist = function(obj){
 var p = Math.abs((obj.x+(62.5/2))-(this.x+(62.5/2)));
var o = Math.abs((obj.y+(62.5/2))-(this.y+(62.5/2)));
var m = Math.pow(p,2);
   var n = Math.pow(o,2);
   var b = m+n;
   var c = Math.sqrt(b);
   return c;
 }
    dist = function(objo,objt){
 var p = Math.abs((objo.x+(62.5/2))-(objt.x+(62.5/2)));
var o = Math.abs((objo.y+(62.5/2))-(objt.y+(62.5/2)));
var m = Math.pow(p,2);
   var n = Math.pow(o,2);
   var b = m+n;
   var c = Math.sqrt(b);
   return c;
 }
//math is pain.
enemy.prototype.point = function(){
if(this.isResting==false){
eadj = Math.abs((playerC.x+(62.5/2))-(this.x+(62.5/2)));
eopp = Math.abs((playerC.y+(62.5/2))-(this.y+(62.5/2)));

ealmost = eopp/eadj;
eans = radians_to_degrees(ealmost);

 if(this.x+(62.5/2)<playerC.x+(62.5/2)&&this.y+(62.5/2)<playerC.y+(62.5/2)){
if (eans>90){
 eans = 90;
}else if(eans<0){
 eans= 0;
}
   eq=1;
this.rotation=eans;
return;
}else if(this.x+(62.5/2)>playerC.x+(62.5/2)&&this.y+(62.5/2)<playerC.y+(62.5/2)){
eans= 180-eans;
if (eans<90){
 eans= 90;
}else if(eans>180){
 eans = 270;
}
  eq=2;
this.rotation=eans;
return;
}else if(this.x+(62.5/2)>playerC.x+(62.5/2)&&this.y+(62.5/2)>playerC.y+(62.5/2)){
eans=180+eans;
if (eans>270){
eans = 270;
}else if(eans<0){
eans = 180;
}
  eq=3;
this.rotation= eans;
return;
}else if(this.x+(62.5/2)<playerC.x+(62.5/2)&&this.y+(62.5/2)>playerC.y+(62.5/2)){
eans= 360-eans;
if (eans>360){
eans = 360;
}else if(eans<270){
eans = 270;
}
  eq=4;
this.rotation=eans;
return;
}
}}
toggle=function(e){
    console.log(e.keyCode);
        if((e.keyCode===71||e.keyCode===103)&&tog==="Yes"){
if(movement==="Relative"){
    movement="Absolute";
}else{movement="Relative";}
}
}
var map = {}; // You could also use an array
onkeydown = onkeyup = function(e){

    e = e || event; // to deal with IE
    map[e.keyCode] = e.type == 'keydown';

}

move = function(){
    adj = Math.abs((playerC.x+(62.5/2))-mouseONE);
opp = Math.abs((playerC.y+(62.5/2))-mouseTWO);

if(adj===0){adj=0.0001;}
        if(opp===0){opp=0.0001;}

  var bt = ((adj/opp)/((adj/opp)+1))*6.25;
  var bh = ((opp/adj)/((opp/adj)+1))*6.25;
if((map[37]===true||map[65]===true)){
if(movement==="Relative"){
       if(q==1){

             playerC.xmotion+=-bt;
     playerC.ymotion+=-bh;
  }else if(q==2){

               playerC.xmotion+=bt;
     playerC.ymotion+=-bh;
       }else if(q==3){

          playerC.xmotion+=bt;
     playerC.ymotion+=bh;
  }else if(q==4){
           playerC.xmotion+=-bt;
     playerC.ymotion+=bh;}}else{
  playerC.xmotion += -6.25;}}


 if((map[38]===true||map[87]===true)){
if(movement==="Relative"){
                    if(q==1){

           playerC.xmotion+=bh;
     playerC.ymotion+=-bt;
  }else if(q==2){

           playerC.xmotion+=bh;
     playerC.ymotion+=bt;
       }else if(q==3){

           playerC.xmotion+=-bh;
     playerC.ymotion+=bt;
  }else if(q==4){

           playerC.xmotion+=-bh;
     playerC.ymotion+=-bt;}}else{
 playerC.ymotion += -6.25;}}



 if((map[39]===true||map[68]===true)){
if(movement==="Relative"){
       if(q==1){
  bt = bt;
   bh = bh;
             playerC.xmotion+=bt;
     playerC.ymotion+=bh;
  }else if(q==2){
    bt = bt*-1;
   bh = bh;
               playerC.xmotion+=bt;
     playerC.ymotion+=bh;
       }else if(q==3){
    bt = bt*-1;
   bh = bh*-1;
               playerC.xmotion+=bt;
     playerC.ymotion+=bh;
  }else if(q==4){
    bt = bt;
   bh = bh*-1;
           playerC.xmotion+=bt;
     playerC.ymotion+=bh;}}else{
     
           playerC.xmotion+=6.25;}}

 

if((map[40]===true||map[83]===true)){
if(movement==="Relative"){
                    if(q==1){

           playerC.xmotion+=-bh;
     playerC.ymotion+=bt;
  }else if(q==2){

           playerC.xmotion+=-bh;
     playerC.ymotion+=-bt;
       }else if(q==3){

           playerC.xmotion+=bh;
     playerC.ymotion+=-bt;
  }else if(q==4){

           playerC.xmotion+=bh;
     playerC.ymotion+=bt;}}else{
 playerC.ymotion += 6.25;}}


    if(stop(playerC)){
 playerC.x +=playerC.xmotion;
  playerC.y +=playerC.ymotion;}
  playerC.xmotion=0;
  playerC.ymotion=0;
}
  enemy.prototype.move = function(){
    
if(e.keyCode===37||e.keyCode===65){
  playerC.xmotion = -6.25;
  playerC.x += playerC.xmotion;
}
 if(e.keyCode===38||e.keyCode===87){
 playerC.ymotion = -6.25;
   playerC.y += playerC.ymotion;
}
 if(e.keyCode===39||e.keyCode===68){
 playerC.xmotion = 6.25;
   playerC.x += playerC.xmotion;
}
if(e.keyCode===40||e.keyCode===83){
 playerC.ymotion = 6.25;
  playerC.y += playerC.ymotion;
}
}

game = function(){


ctx.clearRect(0,0,10000,10000);
playerC.draw();
move();
point();

for(var i = 0; i<enemies.length; i++){
enemies[i].point();
  enemies[i].draw();
  if(enemies[i].dist(playerC)<150){
  enemies[i].isResting=false;
  }


if(enemies[i].bulletss.length>0){
  if(enemies[i].dist(playerC)<300&&enemies[i].isResting==false&&enemies[i].dist(enemies[i].bulletss[0])>800){
      enemies[i].bulletss.pop();
  enemies[i].fire();
  }}else{enemies[i].fire();}
  enemies[i].bulletsmove();
    enemies[i].bulletss[0].draw();
    if(enemies[i].hasShot==1){
      enemies[i].bulletss.pop();
    }
}
    if(bulletss.length>0){
  if(dist(playerC, bulletss[0])>650){
     bulletss.pop();
  

    }
}
    if(bulletss.length===1){
if(stop(bulletss[0])){
   
}else{bulletss[0].exists=false;}}

for(var daps=0; daps<enemies.length;daps++){
        if(enemies[daps].bulletss.length===1){
    if(stop(enemies[daps].bulletss[0])){
     
    }else{ enemies[daps].bulletss[0].exists=false;   }}
}
    for(var dadps=0; dadps<enemies.length;dadps++){
        if(enemies[dadps].bulletss.length===1){
    if(shop(enemies[dadps].bulletss[0])){
     
    }else{loadlevel(5,5,0);  }}
}
    

 done=0; 
for(var i = 0; i<walls.length; i++){
walls[i].draw();}

for(var i = 0; i<bulletss.length; i++){
bulletss[i].draw();
bulletss[i].move();}
    
         ctx.strokeStyle = 'red';
    ctx.lineWidth = 5;

    // draw a red line
    ctx.beginPath();
    ctx.moveTo(playerC.x+(62.5/2), playerC.y+(62.5/2));
    ctx.lineTo(mouseONE, mouseTWO);
    ctx.stroke();
    
window.requestAnimationFrame(game);
    
};
    document.addEventListener("keypress",toggle);
canvas.addEventListener("mousemove",Mouse);
  canvas.addEventListener("click",fire);
loadlevel(5,5,0);  
game();
</script>
</body></html>
